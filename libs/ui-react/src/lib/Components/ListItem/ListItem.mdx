import { Meta, Story, Canvas, Controls } from '@storybook/addon-docs/blocks';
import * as ListItemStories from './ListItem.stories';
import {
  ListItem,
  ListItemLeading,
  ListItemContent,
  ListItemTitle,
  ListItemDescription,
  ListItemTrailing,
  ListItemSpot,
} from './ListItem';
import {
  CustomTabs,
  Tab,
  DoVsDontRow,
  DoBlockItem,
  DontBlockItem,
} from '../../../../.storybook/components';
import CommonRulesDoAndDont from '../../../../.storybook/components/DoVsDont/CommonRulesDoAndDont.mdx';

<Meta title='Components/ListItem' of={ListItemStories} />

# ðŸ“‹ ListItem

<CustomTabs>
  <Tab label="Overview">

## Introduction

ListItems are flexible interactive elements designed for lists. They use a composite component pattern that provides full flexibility over layout and content through composable sub-components.

> View in [Figma](https://www.figma.com/design/JxaLVMTWirCpU0rsbZ30k7/2.-Components-Library?node-id=2255-4155).

## Anatomy

<Canvas of={ListItemStories.Base} />

- **ListItem**: Root interactive container (button)
- **ListItemLeading**: Left section containing visual element and content
- **ListItemSpot**: Spot adapter that inherits disabled state from parent ListItem
- **ListItemContent**: Container for title and description
- **ListItemTitle**: The main label of the item (required)
- **ListItemDescription**: Provides additional context, can include inline Tag
- **ListItemTrailing**: Right section for trailing content (chevron, switch, value, etc.)

## Properties

### Overview

<Canvas of={ListItemStories.Base} />
<Controls of={ListItemStories.Base} />

### Trailing Content Variants

ListItems follow composite component pattern to allow for maximum flexibility over layout and content through composable sub-components.

<Canvas of={ListItemStories.VariantsShowcase} />

### Disabled State

When disabled, the ListItem becomes non-interactive. The disabled state is automatically propagated to ListItemSpot and ListItemDescription via context.

<Canvas of={ListItemStories.DisabledState} />

## Responsive Layout

ListItems adapt to their container width, truncating long titles and descriptions as needed.

<Canvas of={ListItemStories.ResponsiveLayout} />

> **Key behaviors:**
>
> - Automatically fits container width
> - Title truncates to one line
> - Description truncates to one line
> - Icons and trailing content maintain fixed sizes

## Accessibility

To be implemented:

- Color contrast for all elements and states
- Text zoom support
- Keyboard navigation and focus management
- Semantic ARIA attributes (e.g., role="menuitem")
- Proper labeling for screen readers

</Tab>
<Tab label="Implementation">

```bash
npm install @ledgerhq/lumen-ui-react
```

> **Note**: `@ledgerhq/lumen-design-core` and other peer dependencies (`react`, `tailwindcss`, `clsx`, etc.) are required. See our [Setup Guide â†’](?path=/docs/getting-started-setup-tailwind--docs#1-tailwind-config) for complete installation and Tailwind configuration.

## Basic Usage

The ListItem uses a composite component pattern for maximum flexibility:

```tsx
import {
  ListItem,
  ListItemLeading,
  ListItemContent,
  ListItemTitle,
} from '@ledgerhq/lumen-ui-react';

function MyComponent() {
  return (
    <ListItem onClick={() => console.log('Clicked!')}>
      <ListItemLeading>
        <ListItemContent>
          <ListItemTitle>Settings</ListItemTitle>
        </ListItemContent>
      </ListItemLeading>
    </ListItem>
  );
}
```

### With Description

Add a description below the title for additional context:

```tsx
import {
  ListItem,
  ListItemLeading,
  ListItemContent,
  ListItemTitle,
  ListItemDescription,
  ListItemTrailing,
} from '@ledgerhq/lumen-ui-react';
import { ChevronRight } from '@ledgerhq/lumen-ui-react/symbols';

function MyComponent() {
  return (
    <ListItem>
      <ListItemLeading>
        <ListItemContent>
          <ListItemTitle>Account Settings</ListItemTitle>
          <ListItemDescription>
            Manage your profile and preferences
          </ListItemDescription>
        </ListItemContent>
      </ListItemLeading>
      <ListItemTrailing>
        <ChevronRight size={24} />
      </ListItemTrailing>
    </ListItem>
  );
}
```

### With Leading Content

Include a ListItemSpot component as leading icon for visual identification. It automatically inherits the disabled state from the parent ListItem:

```tsx
import {
  ListItem,
  ListItemLeading,
  ListItemContent,
  ListItemTitle,
  ListItemDescription,
  ListItemTrailing,
  ListItemSpot,
} from '@ledgerhq/lumen-ui-react';
import { Settings, ChevronRight } from '@ledgerhq/lumen-ui-react/symbols';

function MyComponent() {
  return (
    <ListItem>
      <ListItemLeading>
        <ListItemSpot appearance='icon' icon={Settings} />
        <ListItemContent>
          <ListItemTitle>Settings</ListItemTitle>
          <ListItemDescription>
            Manage your profile and preferences
          </ListItemDescription>
        </ListItemContent>
      </ListItemLeading>
      <ListItemTrailing>
        <ChevronRight size={24} />
      </ListItemTrailing>
    </ListItem>
  );
}
```

### Trailing Content

The ListItem supports arbitrary trailing content variants. Below are some examples:

```tsx
import { useState } from 'react';
import {
  ListItem,
  ListItemLeading,
  ListItemContent,
  ListItemTitle,
  ListItemDescription,
  ListItemTrailing,
  ListItemSpot,
  Switch,
  Tag,
} from '@ledgerhq/lumen-ui-react';
import { Settings, Check, ChevronRight, User } from '@ledgerhq/lumen-ui-react/symbols';

function ListVariants() {
  const [selected, setSelected] = useState(false);

  return (
    <div className='flex flex-col gap-2 max-w-md'>
      {/* Chevron - For navigation items */}
      <ListItem>
        <ListItemLeading>
          <ListItemSpot appearance='icon' icon={User} />
          <ListItemContent>
            <ListItemTitle>Chevron Variant</ListItemTitle>
            <ListItemDescription>With description</ListItemDescription>
          </ListItemContent>
        </ListItemLeading>
        <ListItemTrailing>
          <ChevronRight size={24} />
        </ListItemTrailing>
      </ListItem>

      {/* Switch - For switchable options */}
      <ListItem onClick={() => setSelected(!selected)}>
        <ListItemLeading>
          <ListItemSpot appearance='icon' icon={User} />
          <ListItemContent>
            <ListItemTitle>Enable Feature</ListItemTitle>
            <ListItemDescription>Toggle this setting on/off</ListItemDescription>
          </ListItemContent>
        </ListItemLeading>
        <ListItemTrailing>
          <Switch selected={selected} />
        </ListItemTrailing>
      </ListItem>

      {/* Value - For displaying values */}
      <ListItem>
        <ListItemLeading>
          <ListItemSpot appearance='icon' icon={User} />
          <ListItemContent>
            <ListItemTitle>Account Balance</ListItemTitle>
            <ListItemDescription>Current available funds</ListItemDescription>
          </ListItemContent>
        </ListItemLeading>
        <ListItemTrailing>
          <div className='text-right'>
            <div className='body-2-semi-bold'>42.00</div>
            <div className='text-muted body-3'>USD</div>
          </div>
        </ListItemTrailing>
      </ListItem>

      {/* Tag - For status indicators */}
      <ListItem>
        <ListItemLeading>
          <ListItemSpot appearance='icon' icon={User} />
          <ListItemContent>
            <ListItemTitle>New Feature</ListItemTitle>
            <ListItemDescription>Recently added functionality</ListItemDescription>
          </ListItemContent>
        </ListItemLeading>
        <ListItemTrailing>
          <Tag label='New' appearance='accent' />
        </ListItemTrailing>
      </ListItem>

      {/* Icon - For trailing icons */}
      <ListItem>
        <ListItemLeading>
          <ListItemSpot appearance='icon' icon={User} />
          <ListItemContent>
            <ListItemTitle>Edit Profile</ListItemTitle>
            <ListItemDescription>Modify your information</ListItemDescription>
          </ListItemContent>
        </ListItemLeading>
        <ListItemTrailing>
          <Check />
        </ListItemTrailing>
      </ListItem>

      {/* None - No trailing content */}
      <ListItem>
        <ListItemLeading>
          <ListItemSpot appearance='icon' icon={User} />
          <ListItemContent>
            <ListItemTitle>Simple Item</ListItemTitle>
            <ListItemDescription>No trailing elements</ListItemDescription>
          </ListItemContent>
        </ListItemLeading>
      </ListItem>
    </div>
  );
}
```

### With Description Tag

Add a tag inline with the description for additional status information:

```tsx
import {
  ListItem,
  ListItemLeading,
  ListItemContent,
  ListItemTitle,
  ListItemDescription,
  ListItemTrailing,
  Tag,
} from '@ledgerhq/lumen-ui-react';
import { Bolt, ChevronRight } from '@ledgerhq/lumen-ui-react/symbols';

function MyComponent() {
  return (
    <ListItem>
      <ListItemLeading>
        <ListItemContent>
          <ListItemTitle>New Item</ListItemTitle>
          <ListItemDescription>
            Recently added
            <Tag label='New' appearance='accent' icon={Bolt} size='sm' />
          </ListItemDescription>
        </ListItemContent>
      </ListItemLeading>
      <ListItemTrailing>
        <ChevronRight size={24} />
      </ListItemTrailing>
    </ListItem>
  );
}
```

### Disabled State

Disable the ListItem to prevent interaction. The disabled state is automatically propagated to ListItemDescription and ListItemSpot via context:

```tsx
import {
  ListItem,
  ListItemLeading,
  ListItemContent,
  ListItemTitle,
  ListItemDescription,
  ListItemTrailing,
  ListItemSpot,
  Switch,
} from '@ledgerhq/lumen-ui-react';
import { Settings } from '@ledgerhq/lumen-ui-react/symbols';

<ListItem disabled>
  <ListItemLeading>
    <ListItemSpot appearance='icon' icon={Settings} />
    <ListItemContent>
      <ListItemTitle>Disabled Option</ListItemTitle>
      <ListItemDescription>Cannot be changed</ListItemDescription>
    </ListItemContent>
  </ListItemLeading>
  <ListItemTrailing>
    <Switch selected={false} disabled />
  </ListItemTrailing>
</ListItem>
```

### Responsive Layout

ListItem handles truncation responsively. Use container widths to control behavior:

```tsx
import {
  ListItem,
  ListItemLeading,
  ListItemContent,
  ListItemTitle,
  ListItemDescription,
  ListItemTrailing,
  ListItemSpot,
} from '@ledgerhq/lumen-ui-react';
import { User, ChevronRight } from '@ledgerhq/lumen-ui-react/symbols';

<div className='w-240 bg-base p-4'>
  <ListItem>
    <ListItemLeading>
      <ListItemSpot appearance='icon' icon={User} />
      <ListItemContent>
        <ListItemTitle>Very Long Title That Will Truncate</ListItemTitle>
        <ListItemDescription>
          Very long description that will also truncate appropriately
        </ListItemDescription>
      </ListItemContent>
    </ListItemLeading>
    <ListItemTrailing>
      <ChevronRight size={24} />
    </ListItemTrailing>
  </ListItem>
</div>
```

### Custom Styling

Use `className` for layout purposes only, such as maximum width:

```tsx
import {
  ListItem,
  ListItemLeading,
  ListItemContent,
  ListItemTitle,
  ListItemDescription,
  ListItemTrailing,
} from '@ledgerhq/lumen-ui-react';
import { ChevronRight } from '@ledgerhq/lumen-ui-react/symbols';

<ListItem className='max-w-md'>
  <ListItemLeading>
    <ListItemContent>
      <ListItemTitle>Constrained Width</ListItemTitle>
      <ListItemDescription>
        This item has a maximum width applied
      </ListItemDescription>
    </ListItemContent>
  </ListItemLeading>
  <ListItemTrailing>
    <ChevronRight size={24} />
  </ListItemTrailing>
</ListItem>
```

### Virtual Lists

When rendering long lists of ListItems, we recommend using [TanStack Virtual](https://tanstack.com/virtual/latest) for optimal performance. Virtual lists only render visible items, significantly improving performance with large datasets.

```tsx
import React from 'react';
import { useVirtualizer } from '@tanstack/react-virtual';
import {
  ListItem,
  ListItemLeading,
  ListItemContent,
  ListItemTitle,
  ListItemDescription,
  ListItemTrailing,
  ListItemSpot,
} from '@ledgerhq/lumen-ui-react';
import { User, ChevronRight } from '@ledgerhq/lumen-ui-react/symbols';

function VirtualListItemList({ items }) {
  const parentRef = React.useRef<HTMLDivElement>(null);

  const virtualizer = useVirtualizer({
    count: items.length,
    getScrollElement: () => parentRef.current,
    estimateSize: () => 64, // Approximate height of ListItem
  });

  return (
    <div ref={parentRef} className='h-400 overflow-auto'>
      <div
        className='relative w-full'
        style={{ height: `${virtualizer.getTotalSize()}px` }}
      >
        {virtualizer.getVirtualItems().map((virtualItem) => (
          <div
            key={virtualItem.key}
            className='absolute left-0 top-0 w-full'
            style={{ transform: `translateY(${virtualItem.start}px)` }}
          >
            <ListItem>
              <ListItemLeading>
                <ListItemSpot appearance='icon' icon={User} />
                <ListItemContent>
                  <ListItemTitle>{items[virtualItem.index].title}</ListItemTitle>
                  <ListItemDescription>
                    {items[virtualItem.index].description}
                  </ListItemDescription>
                </ListItemContent>
              </ListItemLeading>
              <ListItemTrailing>
                <ChevronRight size={24} />
              </ListItemTrailing>
            </ListItem>
          </div>
        ))}
      </div>
    </div>
  );
}
```

> ðŸ“¦ Install with `npm install @tanstack/react-virtual`. See the [TanStack Virtual documentation](https://tanstack.com/virtual/latest/docs/introduction) for more details.

## Do's and Don'ts

The following guidelines ensure consistent usage of the ListItem component and maintain design system principles.

<div className='flex flex-col gap-24'>
  <DoVsDontRow>
    <DoBlockItem
      title='Use the composite pattern correctly'
      description='ListItemContent should be nested inside ListItemLeading to group visual and text content together'
    >

{/* prettier-ignore */}
```tsx
<ListItem>
  <ListItemLeading>
    <ListItemSpot appearance='icon' icon={Settings} />
    <ListItemContent>
      <ListItemTitle>Settings</ListItemTitle>
      <ListItemDescription>Manage preferences</ListItemDescription>
    </ListItemContent>
  </ListItemLeading>
  <ListItemTrailing>
    <ChevronRight size={24} />
  </ListItemTrailing>
</ListItem>
```

    </DoBlockItem>
    <DontBlockItem
      title="Don't place ListItemContent outside ListItemLeading"
      description='ListItemContent must be inside ListItemLeading for proper layout'
    >

{/* prettier-ignore */}
```tsx
// DON'T - ListItemContent outside ListItemLeading
<ListItem>
  <ListItemLeading>
    <ListItemSpot appearance='icon' icon={Settings} />
  </ListItemLeading>
  <ListItemContent>
    <ListItemTitle>Settings</ListItemTitle>
  </ListItemContent>
</ListItem>
```

    </DontBlockItem>

  </DoVsDontRow>

  <DoVsDontRow>
    <DoBlockItem
      title='Add Tags inline with description'
      description='Place Tag components directly inside ListItemDescription for inline display'
    >

{/* prettier-ignore */}
```tsx
<ListItemDescription>
  Recently added
  <Tag label='New' appearance='accent' size='sm' />
</ListItemDescription>
```

    </DoBlockItem>
    <DontBlockItem
      title="Don't place Tags outside ListItemDescription"
      description='Tags should be inline with description text, not separate'
    >

{/* prettier-ignore */}
```tsx
// DON'T - Tag outside description
<ListItemContent>
  <ListItemTitle>New Item</ListItemTitle>
  <ListItemDescription>Recently added</ListItemDescription>
  <Tag label='New' appearance='accent' />
</ListItemContent>
```

    </DontBlockItem>

  </DoVsDontRow>

  <DoVsDontRow>
    <DoBlockItem
      title='Use concise text for title and description'
      description='Keep title and description short since they truncate to one line'
    >

{/* prettier-ignore */}
```tsx
<ListItemContent>
  <ListItemTitle>Account Settings</ListItemTitle>
  <ListItemDescription>Manage preferences</ListItemDescription>
</ListItemContent>
```

    </DoBlockItem>
    <DontBlockItem
      title="Don't use long text"
      description='Title and description truncate to one line'
    >

{/* prettier-ignore */}
```tsx
<ListItemContent>
  <ListItemTitle>
    This is a very long title that will be truncated
  </ListItemTitle>
  <ListItemDescription>
    This is also a very long description that will be truncated
  </ListItemDescription>
</ListItemContent>
```

    </DontBlockItem>

  </DoVsDontRow>

  <CommonRulesDoAndDont />
</div>

</Tab>
</CustomTabs>
