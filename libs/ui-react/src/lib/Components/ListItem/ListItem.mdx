import { Meta, Story, Canvas, Controls } from '@storybook/addon-docs/blocks';
import * as ListItemStories from './ListItem.stories';
import { ListItem } from './ListItem';
import { CustomTabs, Tab } from '../../../../.storybook/CustomTabs';
import {
  DoVsDontRow,
  DoBlockItem,
  DontBlockItem,
} from '../../../../.storybook/DoVsDont';
import CommonRulesDoAndDont from '../../../../.storybook/DoVsDont/CommonRulesDoAndDont.mdx';

<Meta title='Components/ListItem' of={ListItemStories} />

# ðŸ“‹ ListItem

<CustomTabs>
  <Tab label="Overview">

## Introduction

ListItems are flexible interactive elements designed for lists. They provide a structured way to display a title with optional description, leading content (usually a Spot), description tag, and flexible trailing content.

> View in [Figma](https://www.figma.com/design/JxaLVMTWirCpU0rsbZ30k7/2.-Components-Library?node-id=2255-4155).

## Anatomy

<Canvas of={ListItemStories.Base} />

- **Title**: The main label of the item (required)
- **Leading Content (optional)**: Visually represents the item's category or action, usually using a Spot component
- **Description (optional)**: Provides additional context
- **Description Tag (optional)**: Small tag next to description for status or labels
- **Trailing Content (optional)**: Arbitrary content to be displayed on the right side

## Properties

### Overview

<Canvas of={ListItemStories.Base} />
<Controls of={ListItemStories.Base} />

### Trailing Content Variants

ListItems support arbitrary trailing content to suit different interaction patterns:

- **caret**: Navigation indicator (chevron right)
- **switch**: Switch for on/off states (requires `selected` prop)
- **value**: Displays a primary value with optional subvalue
- **tag**: Shows a tag for status or category
- **icon**: Custom trailing icon

<Canvas of={ListItemStories.TrailingContentVariantsShowcase} />

### States

ListItems support standard states including hover, active and disabled.

<Canvas of={ListItemStories.StateShowcase} />

## Responsive Layout

ListItems adapt to their container width, truncating long titles and descriptions as needed.

<Canvas of={ListItemStories.ResponsiveLayout} />

> **Key behaviors:**
>
> - Automatically fits container width
> - Title truncates to one line
> - Description truncates to one line
> - Icons and trailing content maintain fixed sizes

## Accessibility

To be implemented:

- Color contrast for all elements and states
- Text zoom support
- Keyboard navigation and focus management
- Semantic ARIA attributes (e.g., role="menuitem")
- Proper labeling for screen readers

</Tab>
<Tab label="Implementation">

```bash
npm install @ledgerhq/lumen-ui-react
```

> **Note**: `@ledgerhq/lumen-design-core` and other peer dependencies (`react`, `tailwindcss`, `clsx`, etc.) are required. See our [Setup Guide â†’](?path=/docs/getting-started-setup-tailwind--docs#1-tailwind-config) for complete installation and Tailwind configuration.

## Basic Usage

```tsx
import { ListItem } from '@ledgerhq/lumen-ui-react';
import { ChevronRight } from '@ledgerhq/lumen-ui-react/symbols';

function MyComponent() {
  return (
    <ListItem title='Settings' trailingContent={<ChevronRight size={24} />} />
  );
}
```

### With Description

Add a description below the title for additional context:

```tsx
import { ListItem } from '@ledgerhq/lumen-ui-react';
import { ChevronRight } from '@ledgerhq/lumen-ui-react/symbols';

function MyComponent() {
  return (
    <ListItem
      title='Account Settings'
      description='Manage your profile and preferences'
      trailingContent={<ChevronRight size={24} />}
    />
  );
}
```

### With Leading Content

Include a Spot component as leading icon for visual identification:

```tsx
import { ListItem, Spot } from '@ledgerhq/lumen-ui-react';
import { Settings, ChevronRight } from '@ledgerhq/lumen-ui-react/symbols';

function MyComponent() {
  return (
    <ListItem
      title='Settings'
      description='Manage your profile and preferences'
      leadingContent={<Spot appearance='icon' icon={Settings} />}
      trailingContent={<ChevronRight size={24} />}
    />
  );
}
```

### Trailing Content

The ListItem supports arbitrary trailing content variants. Below are some examples:

```tsx
import { useState } from 'react';
import { ListItem, Switch, Tag } from '@ledgerhq/lumen-ui-react';
import {
  Settings,
  Check,
  Bolt,
  ChevronRight,
  User,
} from '@ledgerhq/lumen-ui-react/symbols';

function ListVariants() {
  const [selected, setSelected] = useState(false);

  return (
    <div className='flex flex-col gap-2 max-w-md'>
      {/* Chevron - For navigation items */}
      <ListItem
        title='Chevron Variant'
        description='With description'
        leadingContent={<Spot appearance='icon' icon={User} />}
        trailingContent={<ChevronRight size={24} />}
      />

      {/* Switch - For switchable options */}
      <ListItem
        title='Enable Feature'
        description='Toggle this setting on/off'
        leadingContent={<Spot appearance='icon' icon={User} />}
        onClick={() => setSelected(!selected)}
        trailingContent={<Switch selected={selected} />}
      />

      {/* Value - For displaying values */}
      <ListItem
        title='Account Balance'
        description='Current available funds'
        leadingContent={<Spot appearance='icon' icon={User} />}
        trailingContent={
          <div className='text-right'>
            <div className='body-2-semi-bold'>42.00</div>
            <div className='text-muted body-3'>USD</div>
          </div>
        }
      />

      {/* Tag - For status indicators */}
      <ListItem
        title='New Feature'
        description='Recently added functionality'
        leadingContent={<Spot appearance='icon' icon={User} />}
        trailingContent={<Tag label='New' appearance='accent' />}
      />

      {/* Icon - For trailing icons */}
      <ListItem
        title='Edit Profile'
        description='Modify your information'
        leadingContent={<Spot appearance='icon' icon={User} />}
        trailingContent={<Check />}
      />

      {/* None - No trailing content */}
      <ListItem
        title='Simple Item'
        description='No trailing elements'
        leadingContent={<Spot appearance='icon' icon={User} />}
      />
    </div>
  );
}
```

### With Description Tag

Add a tag to the description for additional status information:

```tsx
import { ListItem, Tag } from '@ledgerhq/lumen-ui-react';
import { Bolt, ChevronRight } from '@ledgerhq/lumen-ui-react/symbols';

function MyComponent() {
  return (
    <ListItem
      title='New Item'
      description='Recently added'
      descriptionTag={<Tag label='New' appearance='accent' icon={Bolt} />}
      trailingContent={<ChevronRight size={24} />}
    />
  );
}
```

### Disabled State

Disable the ListItem to prevent interaction:

```tsx
import { ListItem, Switch } from '@ledgerhq/lumen-ui-react';

<ListItem
  title='Disabled Option'
  description='Cannot be changed'
  trailingContent={<Switch selected={false} disabled />}
  disabled
/>;
```

### Responsive Layout

ListItem handles truncation responsively. Use container widths to control behavior:

```tsx
import { ListItem, Spot } from '@ledgerhq/lumen-ui-react';
import { User, ChevronRight } from '@ledgerhq/lumen-ui-react/symbols';

<div className='w-240 bg-base p-4'>
  <ListItem
    title='Very Long Title That Will Truncate'
    description='Very long description that will also truncate appropriately'
    leadingContent={<Spot appearance='icon' icon={User} />}
    trailingContent={<ChevronRight size={24} />}
  />
</div>;
```

### Custom Styling

Use `className` for layout purposes only, such as maximum width:

```tsx
import { ListItem } from '@ledgerhq/lumen-ui-react';
import { ChevronRight } from '@ledgerhq/lumen-ui-react/symbols';

<ListItem
  title='Constrained Width'
  description='This item has a maximum width applied'
  trailingContent={<ChevronRight size={24} />}
  className='max-w-md'
/>;
```

### Virtual Lists

When rendering long lists of ListItems, we recommend using [TanStack Virtual](https://tanstack.com/virtual/latest) for optimal performance. Virtual lists only render visible items, significantly improving performance with large datasets.

```tsx
import { useVirtualizer } from '@tanstack/react-virtual';
import { ListItem, Spot } from '@ledgerhq/ldls-ui-react';
import { User, ChevronRight } from '@ledgerhq/ldls-ui-react/symbols';

function VirtualListItemList({ items }) {
  const parentRef = React.useRef<HTMLDivElement>(null);

  const virtualizer = useVirtualizer({
    count: items.length,
    getScrollElement: () => parentRef.current,
    estimateSize: () => 64, // Approximate height of ListItem
  });

  return (
    <div ref={parentRef} className='h-400 overflow-auto'>
      <div
        className='relative w-full'
        style={{ height: `${virtualizer.getTotalSize()}px` }}
      >
        {virtualizer.getVirtualItems().map((virtualItem) => (
          <div
            key={virtualItem.key}
            className='absolute left-0 top-0 w-full'
            style={{ transform: `translateY(${virtualItem.start}px)` }}
          >
            <ListItem
              title={items[virtualItem.index].title}
              description={items[virtualItem.index].description}
              leadingContent={<Spot appearance='icon' icon={User} />}
              trailingContent={<ChevronRight size={24} />}
            />
          </div>
        ))}
      </div>
    </div>
  );
}
```

> ðŸ“¦ Install with `npm install @tanstack/react-virtual`. See the [TanStack Virtual documentation](https://tanstack.com/virtual/latest/docs/introduction) for more details.

## Do's and Don'ts

The following guidelines ensure consistent usage of the ListItem component and maintain design system principles.

<div className='flex flex-col gap-24'>
  <DoVsDontRow>
    <DoBlockItem
      title='Use descriptionTag to add Tag components'
      description='descriptionTag prop accepts Tag components to display status or labels next to the description'
    >

{/* prettier-ignore */}
```tsx
<ListItem
  title='New Item'
  description='Recently added'
  descriptionTag={<Tag label='New' appearance='accent' icon={Bolt} />}
/>
```

    </DoBlockItem>
    <DontBlockItem
      title="Don't use descriptionTag for other elements"
      description='descriptionTag only accepts Tag components. Use trailingContent for other elements like icons or text'
    >

{/* prettier-ignore */}
```tsx
// DON'T - descriptionTag only accepts Tag components
<ListItem
  title='New Item'
  description='Recently added'
  descriptionTag={<span>New</span>}
/>


```

    </DontBlockItem>

  </DoVsDontRow>

  <DoVsDontRow>
    <DoBlockItem
      title='Use concise text for title and description'
      description='Keep title and description short since they truncate to one line'
    >

{/* prettier-ignore */}
```tsx
import { ListItem } from '@ledgerhq/lumen-ui-react';
import { ChevronRight } from '@ledgerhq/lumen-ui-react/symbols';

<ListItem
  title='Account Settings'
  description='Manage preferences'
  trailingContent={<ChevronRight size={24} />}
/>
```

    </DoBlockItem>
    <DontBlockItem
      title="Don't use long text"
      description='Title and description truncate to one line'
    >

{/* prettier-ignore */}
```tsx
import { ListItem } from '@ledgerhq/lumen-ui-react';
import { ChevronRight } from '@ledgerhq/lumen-ui-react/symbols';

<ListItem
  title='This is a very long title that will be truncated and users will not be able to read the full text'
  description='This is also a very long description that will be truncated and users will not be able to read the full text'
  trailingContent={<ChevronRight size={24} />}
/>
```

    </DontBlockItem>

  </DoVsDontRow>

  <CommonRulesDoAndDont />
</div>

</Tab>
</CustomTabs>
