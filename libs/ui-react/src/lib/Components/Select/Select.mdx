import { Meta, Canvas, Controls } from '@storybook/addon-docs/blocks';
import * as SelectStories from './Select.stories';
import { CustomTabs, Tab } from '../../../../.storybook/CustomTabs';
import {
  DoVsDontRow,
  DoBlockItem,
  DontBlockItem,
} from '../../../../.storybook/DoVsDont';
import CommonRulesDoAndDont from '../../../../.storybook/DoVsDont/CommonRulesDoAndDont.mdx';

<Meta title='Components/Select' of={SelectStories} />

# ðŸ“‹ Select

<CustomTabs>
  <Tab label='Overview'>

## Introduction

The Select component provides a dropdown interface for choosing from a list of options. Built on Radix UI primitives, it offers excellent accessibility, keyboard navigation, and a modern floating label design that matches our BaseInput component.

> View in [Figma](https://www.figma.com/design/JxaLVMTWirCpU0rsbZ30k7/2.-Components-Library?node-id=6397-463&m=dev).

## Anatomy

<Canvas of={SelectStories.Base} />

- **Trigger**: The clickable element that opens the dropdown with floating label support
- **Label**: Optional floating label that animates when a value is selected
- **Value**: The currently selected value
- **Icon**: Chevron down/up indicator
- **Content**: The dropdown container with options
- **Items**: Individual selectable options
- **Groups**: Optional grouping of related items with labels
- **Separators**: Visual dividers between groups
- **Scroll Up Button**: Button to scroll up the content
- **Scroll Down Button**: Button to scroll down the content

## Properties

### Basic Usage

<Canvas of={SelectStories.Base} />

### With Groups and Separators

Organize related options using groups with labels and separators for better user experience.

<Canvas of={SelectStories.WithGroups} />

### Long Lists

The component handles long lists with proper scrolling and keyboard navigation.

<Canvas of={SelectStories.LongList} />

### Disabled State

The select can be disabled to prevent user interaction.

<Canvas of={SelectStories.Disabled} />

### With Default Value

Provide an initial value using the `defaultValue` prop for uncontrolled usage.

<Canvas of={SelectStories.WithDefaultValue} />

### With Description

The select can display a description for each item.

<Canvas of={SelectStories.WithDescription} />

### Form Integration

The Select component integrates seamlessly with HTML forms.

<Canvas of={SelectStories.FormIntegration} />

## Accessibility

- **Keyboard Navigation**: Full keyboard support with arrow keys, Enter, Space, and Escape
- **Screen Reader Support**: Proper ARIA attributes and roles
- **Focus Management**: Clear focus indicators and logical tab order
- **High Contrast**: Compatible with high contrast mode
- **Form Integration**: Works with native form submission

</Tab>

<Tab label='Implementation'>

## Overview

This component is built on top of [radix-ui/react-select](https://www.radix-ui.com/docs/primitives/components/select), which provides a robust foundation using Radix UI primitives. We've customized it to match our design system while maintaining all the accessibility and functionality features.

```bash
npm install @ledgerhq/ldls-ui-react @radix-ui/react-select
```

> **Note**: `@ledgerhq/ldls-design-core` and other peer dependencies (`react`, `tailwindcss`, `clsx`, etc.) are required. See our [Setup Guide â†’](?path=/docs/getting-started-setup-tailwind--docs#1-tailwind-config) for complete installation and Tailwind configuration.

The `@radix-ui/react-select` dependency provides accessible, unstyled select functionality with proper keyboard navigation, focus management, and screen reader support.

## Basic Usage

```tsx
import {
  Select,
  SelectContent,
  SelectItem,
  SelectItemText,
  SelectTrigger,
} from '@ledgerhq/ldls-ui-react';

function MyComponent() {
  const [value, setValue] = useState('');

  return (
    <Select value={value} onValueChange={setValue}>
      <SelectTrigger label='Label' />
      <SelectContent>
        <SelectItem value='option1'>
          <SelectItemText>Option 1</SelectItemText>
        </SelectItem>
        <SelectItem value='option2'>
          <SelectItemText>Option 2</SelectItemText>
        </SelectItem>
        <SelectItem value='option3'>
          <SelectItemText>Option 3</SelectItemText>
        </SelectItem>
      </SelectContent>
    </Select>
  );
}
```

<Controls of={SelectStories.Base} />

### With Descriptions

You can add descriptions or additional content to select items by including extra elements alongside `SelectItemText`:

```tsx
import {
  Select,
  SelectContent,
  SelectItem,
  SelectItemText,
  SelectTrigger,
} from '@ledgerhq/ldls-ui-react';
import { Tag } from '@ledgerhq/ldls-ui-react';

function MyComponent() {
  const [value, setValue] = useState('');

  return (
    <Select value={value} onValueChange={setValue}>
      <SelectTrigger label='Label' />
      <SelectContent>
        <SelectItem
          value='option1'
          className='flex flex-col items-start justify-start gap-2'
        >
          <SelectItemText>Premium Plan</SelectItemText>
          <div className='body-4 text-muted'>Best for professionals</div>
        </SelectItem>
        <SelectItem
          value='option2'
          className='flex flex-col items-start justify-start gap-2'
        >
          <SelectItemText>Basic Plan</SelectItemText>
          <div className='body-4 text-muted'>Perfect for starters</div>
        </SelectItem>
        <SelectItem value='option3' className='flex items-center gap-8'>
          <SelectItemText>New Feature</SelectItemText>
          <Tag label='new' appearance='accent' size='sm' />
        </SelectItem>
      </SelectContent>
    </Select>
  );
}
```

**Important:** Always use `SelectItemText` for the main option text. Description text should be placed in separate elements alongside `SelectItemText`, never inside it.

<div className='flex flex-col gap-24'>
  <DoVsDontRow>
    <DoBlockItem
      title='Use SelectItemText for main text'
      description='Place description text in separate elements alongside SelectItemText'
    >

```tsx
<SelectItem value='option1' className='flex flex-col items-start gap-4'>
  <SelectItemText>Option Title</SelectItemText>
  <div className='body-4 text-muted'>This is a correct description</div>
</SelectItem>
```

    </DoBlockItem>
    <DontBlockItem
      title="Don't nest description inside SelectItemText"
      description='Avoid nesting description or using raw text without SelectItemText'
    >

{/* prettier-ignore */}
```tsx
<SelectItem value='option1'>
  <SelectItemText>
    Option Title
    <div>This a wrong description</div>
  </SelectItemText>
</SelectItem>
```

    </DontBlockItem>

  </DoVsDontRow>
</div>

### With Groups

```tsx
import {
  Select,
  SelectContent,
  SelectGroup,
  SelectItem,
  SelectItemText,
  SelectLabel,
  SelectSeparator,
  SelectTrigger,
} from '@ledgerhq/ldls-ui-react';

function MyComponent() {
  const [value, setValue] = useState('');

  return (
    <Select value={value} onValueChange={setValue}>
      <SelectTrigger label='Category' />
      <SelectContent>
        <SelectGroup>
          <SelectLabel>Fruits</SelectLabel>
          <SelectItem value='apple'>
            <SelectItemText>Apple</SelectItemText>
          </SelectItem>
          <SelectItem value='banana'>
            <SelectItemText>Banana</SelectItemText>
          </SelectItem>
        </SelectGroup>
        <SelectSeparator />
        <SelectGroup>
          <SelectLabel>Vegetables</SelectLabel>
          <SelectItem value='carrot'>
            <SelectItemText>Carrot</SelectItemText>
          </SelectItem>
          <SelectItem value='broccoli'>
            <SelectItemText>Broccoli</SelectItemText>
          </SelectItem>
        </SelectGroup>
      </SelectContent>
    </Select>
  );
}
```

### Controlled vs Uncontrolled

The Select component supports both controlled and uncontrolled usage patterns:

```tsx
// Controlled
const [value, setValue] = useState('option1');
<Select value={value} onValueChange={setValue}>

// Uncontrolled
<Select defaultValue='option1' onValueChange={(value) => console.log(value)}>
```

### Form Integration

The Select component integrates seamlessly with HTML forms:

```tsx
<form onSubmit={handleSubmit}>
  <Select name='category' required>
    <SelectTrigger label='Category' />
    <SelectContent>
      <SelectItem value='tech'>
        <SelectItemText>Technology</SelectItemText>
      </SelectItem>
      <SelectItem value='design'>
        <SelectItemText>Design</SelectItemText>
      </SelectItem>
      <SelectItem value='business'>
        <SelectItemText>Business</SelectItemText>
      </SelectItem>
    </SelectContent>
  </Select>
  <button type='submit'>Submit</button>
</form>
```

### With Scroll Buttons

The scroll buttons are automatically included in `SelectContent` to indicate when there's more content available. They appear when the list is scrollable:

```tsx
import {
  Select,
  SelectContent,
  SelectItem,
  SelectItemText,
  SelectTrigger,
} from '@ledgerhq/ldls-ui-react';

function MyComponent() {
  const [value, setValue] = useState('');

  const countries = [
    'United States',
    'Canada',
    'Mexico',
    'Brazil',
    'Argentina',
    // ... more items
  ];

  return (
    <Select value={value} onValueChange={setValue}>
      <SelectTrigger label='Country' />
      <SelectContent>
        {/* Scroll buttons are automatically included in SelectContent */}
        {countries.map((country) => (
          <SelectItem key={country} value={country.toLowerCase()}>
            <SelectItemText>{country}</SelectItemText>
          </SelectItem>
        ))}
      </SelectContent>
    </Select>
  );
}
```

> **Note:** `SelectScrollUpButton` and `SelectScrollDownButton` are automatically rendered inside `SelectContent`.

## Do's and Don'ts

<div className='flex flex-col gap-24'>
  <DoVsDontRow>
    <DoBlockItem
      title='Use proper component composition'
      description='Use all required sub-components: SelectTrigger, SelectContent, SelectItem, and SelectItemText'
    >

{/* prettier-ignore */}
```tsx
<Select value={value} onValueChange={setValue}>
  <SelectTrigger label='Category' />
  <SelectContent>
    <SelectItem value='option1'>
      <SelectItemText>Option 1</SelectItemText>
    </SelectItem>
  </SelectContent>
</Select>
```

    </DoBlockItem>
    <DontBlockItem
      title="Don't skip required components"
      description='All sub-components are required. Do not skip SelectItemText or use raw text in SelectItem'
    >

{/* prettier-ignore */}
```tsx
<Select value={value} onValueChange={setValue}>
  <SelectTrigger label='Category' />
  <SelectContent>
    <SelectItem value='option1'>
      Option 1
    </SelectItem>
  </SelectContent>
</Select>
```

    </DontBlockItem>

  </DoVsDontRow>

  <DoVsDontRow>
    <DoBlockItem
      title='Use labelClassName for label styling'
      description='Use labelClassName prop on SelectTrigger to style the floating label specifically'
    >

{/* prettier-ignore */}
```tsx
<Select value={value} onValueChange={setValue}>
  <SelectTrigger 
    label='Category' 
    labelClassName='font-semibold'
  />
  <SelectContent>
    <SelectItem value='option1'>
      <SelectItemText>Option 1</SelectItemText>
    </SelectItem>
  </SelectContent>
</Select>
```

    </DoBlockItem>
    <DontBlockItem
      title="Don't use className to style the label"
      description='className on SelectTrigger styles the trigger element, not the label. Use labelClassName instead'
    >

{/* prettier-ignore */}
```tsx
<Select value={value} onValueChange={setValue}>
  <SelectTrigger 
    label='Category' 
    className='font-semibold'
  />
  <SelectContent>
    <SelectItem value='option1'>
      <SelectItemText>Option 1</SelectItemText>
    </SelectItem>
  </SelectContent>
</Select>
```

    </DontBlockItem>

  </DoVsDontRow>

  <CommonRulesDoAndDont />
</div>

</Tab>
</CustomTabs>
