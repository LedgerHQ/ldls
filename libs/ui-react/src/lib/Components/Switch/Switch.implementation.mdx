import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Components/Switch/Implementation" />

# Switch Component Implementation

## Installation

Install the packages and their peer dependencies:

```bash
# Install the UI Kit
npm install @ledgerhq/ldls-ui-react @ledgerhq/ldls-design-core

# Install peer dependencies
npm install tailwindcss@^3.4.0 react@^18.3.1 clsx tailwind-merge class-variance-authority @radix-ui/react-switch
```

#### About @radix-ui/react-switch

The `@radix-ui/react-switch` dependency is used internally by the Switch component
to provide accessible, unstyled switch functionality with proper keyboard navigation,
focus management, and screen reader support. It handles the core switch behavior including
pressed/unpressed states and accessibility features, while our component adds the visual styling and design system tokens.

### Tailwind Configuration

To use the Switch component with our custom Tailwind preset, you need to configure your `tailwind.config.ts`:

```typescript
import type { Config } from 'tailwindcss';
import { ledgerLivePreset } from '@ledgerhq/ldls-design-core';

const config = {
  content: [
    "./src/**/*.{js,ts,jsx,tsx}", // Your project's files
    "./node_modules/@ledgerhq/ldls-ui-react/dist/lib/**/*.{js,ts,jsx,tsx}" // Ledger UI Kit components
  ],
  presets: [ledgerLivePreset], // the installed tailwind preset
} satisfies Config;

export default config;
```

## Basic Usage

```tsx
import { Switch } from '@ledgerhq/ldls-ui-react';

function MyComponent() {
  return <Switch />;
}
```

## Controlled vs Uncontrolled

### Controlled Usage

Use the `selected` and `onChange` props for full control:

```tsx
import { useState } from 'react';
import { Switch } from '@ledgerhq/ldls-ui-react';

function MyComponent() {
  const [selected, setSelected] = useState(false);

  return (
    <Switch
      selected={selected}
      onChange={(selected) => setSelected(selected)}
    />
  );
}
```

### Uncontrolled

Use `defaultSelected` for simple cases:

```tsx
<Switch defaultSelected={true} />
```

## Accessibility Best Practices

### Labels and ARIA

```tsx
// ✅ Associated label
<div className="flex items-center space-x-8">
  <Switch id="my-switch" />
  <label htmlFor="my-switch">Enabled</label>
</div>

// ✅ ARIA label for standalone switch
<Switch aria-label="Select all items" />

// ✅ ARIA described by for complex descriptions
<div>
  <Switch
    id="marketing"
    aria-describedby="marketing-description"
  />
  <label htmlFor="marketing">Enable marketing emails</label>
  <p id="marketing-description" className="text-muted body-4">
    Receive promotional offers and product updates
  </p>
</div>
```

### Keyboard Navigation

The Switch component automatically supports:

- **Tab**: Navigate to the Switch
- **Space** or **Enter**: Switch selected/unselected state

## Do's and Don'ts

The following guidelines ensure consistent usage of the Switch component and maintain design system principles.

### Layout and Styling

✅ **Do**

````tsx
// Use className for responsive behavior
<Switch className="hidden md:block" />

// Use className for margins and positioning
<Switch className="mt-2 mr-4" />

// Use the size prop
<Switch size="sm" />

❌ **Don't**

```tsx
// Don't override the core styling
<Switch className="bg-base border-muted" />
// Don't modify the appearance
<Switch className="w-32 h-20 rounded-lg" />
// Don't modify internal spacing or padding
<Switch className="p-4" />
````

> **Note**: Use `className` only for layout-related utilities (positioning, margins, display properties). The switch's core styling (colors, size, focus states, etc.) should be controlled through the design system to maintain consistency.

### State Management

✅ **Do**

```tsx
// Use controlled components for form state
const [isSelected, setIsSelected] = useState(false);
<Switch selected={isSelected} onChange={setIsSelected} />
// Use defaultSelected for simple uncontrolled cases
<Switch defaultSelected={false} />
```

❌ **Don't**

```tsx
// Don't mix controlled and uncontrolled patterns
<Switch selected={isSelected} defaultSelected={true} />
// Don't ignore state change handlers
<Switch selected={isSelected} />
// Don't use string values for selected state
<Switch selected="true" />
```
