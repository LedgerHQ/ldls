import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Components/Checkbox/Implementation" />

# Checkbox Component Implementation

## Installation

First, ensure you are connected to the VPN, login to the npm registry and create a `.npmrc` file in your project root:

```bash
npm login --registry=https://jfrog.ledgerlabs.net/artifactory/api/npm/ldls-npm-prod-public/
```

```bash
# .npmrc
@ldls:registry=https://jfrog.ledgerlabs.net/artifactory/api/npm/ldls-npm-prod-public/
```

Then install the packages and their peer dependencies:

```bash
# Install the UI Kit
npm install @ledgerhq/ldls-ui-react @ledgerhq/ldls-design-core

# Install peer dependencies
npm install tailwindcss@^3.4.0 react@^18.3.1 clsx tailwind-merge class-variance-authority @radix-ui/react-checkbox
```

#### About @radix-ui/react-checkbox

The `@radix-ui/react-checkbox` dependency is used internally by the Checkbox component
to provide accessible, unstyled checkbox functionality with proper keyboard navigation,
focus management, and screen reader support. It handles the core checkbox behavior including
checked/unchecked states, form integration, and accessibility features, while our component adds the visual styling and design system tokens.

### Tailwind Configuration

To use the Button component with our custom Tailwind preset, you need to configure your `tailwind.config.ts`:

```typescript
import type { Config } from 'tailwindcss';
import { ledgerLivePreset } from '@ledgerhq/ldls-design-core';

const config = {
  content: [
    "./src/**/*.{js,ts,jsx,tsx}", // Your project's files
    "./node_modules/@ledgerhq/ldls-ui-react/dist/lib/**/*.{js,ts,jsx,tsx}" // Ledger UI Kit components
  ],
  presets: [ledgerLivePreset], // the installed tailwind preset
} satisfies Config;

export default config;
```

## Basic Usage

```tsx
import { Checkbox } from '@ledgerhq/ldls-ui-react';

function MyForm() {
  const [isChecked, setIsChecked] = useState(false);

  return (
    <div className="flex items-center space-x-8">
      <Checkbox
        checked={isChecked}
        onCheckedChange={setIsChecked}
      />
      <label>Accept terms and conditions</label>
    </div>
  );
}
```

## Controlled vs Uncontrolled

### Controlled

Use the `checked` and `onCheckedChange` props for full control:

```tsx
const [checked, setChecked] = useState(false);

<Checkbox
  checked={checked}
  onCheckedChange={setChecked}
/>
```

### Uncontrolled

Use `defaultChecked` for simple cases:

```tsx
<Checkbox defaultChecked={true} />
```

## Accessibility Best Practices

### Labels and ARIA

```tsx
// ✅ Associated label
<div className="flex items-center space-x-8">
  <Checkbox id="terms" />
  <label htmlFor="terms">I agree to the terms</label>
</div>

// ✅ ARIA label for standalone checkbox
<Checkbox aria-label="Select all items" />

// ✅ ARIA described by for complex descriptions
<div>
  <Checkbox
    id="marketing"
    aria-describedby="marketing-description"
  />
  <label htmlFor="marketing">Marketing emails</label>
  <p id="marketing-description" className="text-muted body-4">
    Receive promotional offers and product updates
  </p>
</div>
```

### Keyboard Navigation

The Checkbox component automatically supports:

- **Tab**: Navigate to the checkbox
- **Space**: Toggle checked/unchecked state
- **Enter**: Submit form (when inside a form)

## Do's and Don'ts

The following guidelines ensure consistent usage of the Checkbox component and maintain design system principles.

### Layout and Styling

✅ **Do**

````tsx
// Use className for responsive behavior
<Checkbox className="hidden md:block" />

// Use className for margins and positioning
<Checkbox className="mt-2 mr-4" />

❌ **Don't**

```tsx
// Don't override checkbox's core styling
<Checkbox className="bg-base border-muted" />

// Don't modify checkbox size or appearance
<Checkbox className="w-24 h-24 rounded-lg" />

// Don't modify internal spacing or padding
<Checkbox className="p-2" />
````

> **Note**: Use `className` only for layout-related utilities (positioning, margins, display properties). The checkbox's core styling (colors, size, border, focus states, etc.) should be controlled through the design system to maintain consistency.

### Accessibility and Labels

✅ **Do**

```tsx
// Associate labels properly
<div className="flex items-center space-x-8">
  <Checkbox id="newsletter" />
  <label htmlFor="newsletter">Subscribe to newsletter</label>
</div>

// Use aria-label for standalone checkboxes
<Checkbox aria-label="Select all items" />

// Provide descriptions when needed
<Checkbox
  id="terms"
  aria-describedby="terms-description"
/>
```

❌ **Don't**

```tsx
// Don't use unlabeled checkboxes
<Checkbox />
```

### State Management

✅ **Do**

```tsx
// Use controlled components for form state
const [isChecked, setIsChecked] = useState(false);
<Checkbox checked={isChecked} onCheckedChange={setIsChecked} />

// Handle form integration properly
<form onSubmit={handleSubmit}>
  <Checkbox name="preferences" value="marketing" />
</form>

// Use defaultChecked for simple uncontrolled cases
<Checkbox defaultChecked={false} />
```

❌ **Don't**

```tsx
// Don't mix controlled and uncontrolled patterns
<Checkbox checked={isChecked} defaultChecked={true} />

// Don't ignore state change handlers
<Checkbox checked={isChecked} />

// Don't use string values for checked state
<Checkbox checked="true" />
```
