import { Meta, Canvas, Controls } from '@storybook/addon-docs/blocks';
import * as TooltipStories from './Tooltip.stories';
import { CustomTabs, Tab } from '../../../../.storybook/CustomTabs';
import {
  DoVsDontRow,
  DoBlockItem,
  DontBlockItem,
} from '../../../../.storybook/DoVsDont';
import CommonRulesDoAndDont from '../../../../.storybook/DoVsDont/CommonRulesDoAndDont.mdx';

<Meta title='Communication/Tooltip' of={TooltipStories} />

# üí¨ Tooltip

<CustomTabs>
  <Tab label="Overview">

View in [Figma](https://www.figma.com/design/JxaLVMTWirCpU0rsbZ30k7/2.-Components-Library?node-id=9199-17893&m=dev)

## Introduction

Tooltips display contextual information in a bottom sheet when users press an interactive element. They're designed for mobile interfaces where hover states don't exist.

## Anatomy

- **TooltipTrigger:** The interactive element that opens the tooltip
- **TooltipContent:** Defines the title and content displayed in the bottom sheet
- **GlobalTooltipBottomSheet:** The shared bottom sheet that renders all tooltip content

## Properties

### Base Example

‚ö†Ô∏è React-native-web doesn't support closing the tooltip by clicking outside of it.

<Canvas of={TooltipStories.Base} />

### With Custom Content

Tooltips can contain rich content including text, buttons, and custom layouts.

<Canvas of={TooltipStories.WithCustomContent} />

### Multiple Tooltips

Multiple tooltips can be used on the same page. Only one tooltip displays at a time.

<Canvas of={TooltipStories.WithMultipleTooltips} />

### With Change Callback

The `onOpenChange` prop is called with the opened state whenever the tooltip opens or closes.

<Canvas of={TooltipStories.WithChangeCallback} />

### Accessibility

- Tooltips use bottom sheets for better touch interaction on mobile
- Content is announced by screen readers
- Dismissible via backdrop press or swipe gesture

</Tab>
<Tab label="Implementation">

## Setup

Install and set up the library with our [Setup Guide ‚Üí](?path=/docs/getting-started-setup--docs).

### Requirements

To use tooltips, you must include two global components in your app setup:

1. **ThemeProvider** ‚Äì Wrap your entire app and register theme and shared components context.
2. **GlobalTooltipBottomSheet** ‚Äì Instance of the bottom sheet component that will be used to display the tooltip content.

```tsx
import { ThemeProvider } from '@ledgerhq/ldls-ui-rnative';
import { GlobalTooltipBottomSheet } from '@ledgerhq/ldls-ui-rnative';

function App() {
  return (
    <ThemeProvider>
      <YourAppContent />
      <GlobalTooltipBottomSheet />
    </ThemeProvider>
  );
}
```

### Basic Usage

```tsx
import {
  Tooltip,
  TooltipTrigger,
  TooltipContent,
} from '@ledgerhq/ldls-ui-rnative';
import { Button } from '@ledgerhq/ldls-ui-rnative';

function MyComponent() {
  return (
    <Tooltip>
      <TooltipTrigger asChild>
        <Button>Help</Button>
      </TooltipTrigger>
      <TooltipContent
        title='Help Information'
        content={<Text>This is helpful information about the feature.</Text>}
      />
    </Tooltip>
  );
}
```

### With Custom Content

```tsx
<Tooltip>
  <TooltipTrigger asChild>
    <InteractiveIcon iconType='filled'>
      <Information />
    </InteractiveIcon>
  </TooltipTrigger>
  <TooltipContent
    title='Feature Details'
    content={
      <View className='flex gap-12'>
        <Text className='text-muted'>
          Detailed explanation with rich formatting.
        </Text>
        <Button size='xs' appearance='accent'>
          Learn More
        </Button>
      </View>
    }
  />
</Tooltip>
```

### Callback function

The `onOpenChange` callback is called when the tooltip is opened or closed.

```tsx
function CallbackFunctionTooltip() {
  return (
    <Tooltip
      onOpenChange={(isOpen) => {
        // handle action, like tracking an event for instance
        trackService.event('tooltip_opened', { isOpen });
      }}
    >
      <TooltipTrigger asChild>
        <Button>Toggle Tooltip</Button>
      </TooltipTrigger>
      <TooltipContent title='Controlled' content={<Text>Content</Text>} />
    </Tooltip>
  );
}
```

## Do's and Don'ts

<div className='flex flex-col gap-24'>
  <DoVsDontRow>
    <DoBlockItem
      title='Use asChild to merge props with existing components'
      description='Use asChild prop on TooltipTrigger to merge tooltip functionality with interactive components'
    >

{/* prettier-ignore */}
```tsx
<TooltipTrigger asChild>
  <Button>Help</Button>
</TooltipTrigger>

<TooltipTrigger asChild>
  <InteractiveIcon iconType='filled'>
    <Information />
  </InteractiveIcon>
</TooltipTrigger>
```

    </DoBlockItem>
    <DontBlockItem
      title="Don't wrap non-interactive elements"
      description='Avoid using TooltipTrigger with static text or non-interactive elements'
    >

{/* prettier-ignore */}
```tsx
<TooltipTrigger asChild>
  <Text>Static Text</Text>
</TooltipTrigger>

<TooltipTrigger asChild>
  <View>
    <Text>Non-interactive</Text>
  </View>
</TooltipTrigger>
```

    </DontBlockItem>

  </DoVsDontRow>

  <DoVsDontRow>
    <DoBlockItem
      title='Keep content concise and helpful'
      description='Provide brief, clear explanations in tooltip content'
    >

{/* prettier-ignore */}
```tsx
<TooltipContent
  title='Short Title'
  content={<Text>Brief, helpful explanation.</Text>}
/>
```

    </DoBlockItem>
    <DontBlockItem
      title="Don't use overly long or complex content"
      description='Avoid verbose explanations or complex layouts in tooltips'
    >

{/* prettier-ignore */}
```tsx
<TooltipContent
  title='Very Long Detailed Title That Goes On Forever'
  content={<Text>This is a very long explanation that contains too much information...</Text>}
/>
```

    </DontBlockItem>

  </DoVsDontRow>

  <DoVsDontRow>
    <DoBlockItem
      title='Include GlobalTooltipBottomSheet at root level'
      description='Add GlobalTooltipBottomSheet once in your app root, after ThemeProvider'
    >

{/* prettier-ignore */}
```tsx
function App() {
  return (
    <ThemeProvider>
      <Navigation />
      <GlobalTooltipBottomSheet />
    </ThemeProvider>
  );
}
```

    </DoBlockItem>
    <DontBlockItem
      title="Don't include GlobalTooltipBottomSheet multiple times"
      description='Only include GlobalTooltipBottomSheet once at the root level'
    >

{/* prettier-ignore */}
```tsx
function App() {
  return (
    <ThemeProvider>
      <Navigation />
      <GlobalTooltipBottomSheet />
      <GlobalTooltipBottomSheet /> {/* Don't duplicate */}
    </ThemeProvider>
  );
}
```

    </DontBlockItem>

  </DoVsDontRow>

  <DoVsDontRow>
    <DoBlockItem
      title='Use multiple separate tooltips'
      description='Create independent tooltip instances for different trigger elements'
    >

{/* prettier-ignore */}
```tsx
<View>
  <Tooltip>
    <TooltipTrigger asChild>
      <Button>Help 1</Button>
    </TooltipTrigger>
    <TooltipContent title='First' content={<Text>Info</Text>} />
  </Tooltip>

  <Tooltip>
    <TooltipTrigger asChild>
      <Button>Help 2</Button>
    </TooltipTrigger>
    <TooltipContent title='Second' content={<Text>Info</Text>} />
  </Tooltip>
</View>
```

    </DoBlockItem>
    <DontBlockItem
      title="Don't nest tooltips"
      description='Avoid nesting Tooltip components inside each other'
    >

{/* prettier-ignore */}
```tsx
<View>
  <Tooltip>
    <TooltipTrigger asChild>
      <Button>Help 1</Button>
    </TooltipTrigger>
    <TooltipContent title='First' content={<Text>Info</Text>} />
  </Tooltip>

  <Tooltip>
    <TooltipTrigger>
      <Tooltip>...</Tooltip>
    </TooltipTrigger>
  </Tooltip>
</View>
```

    </DontBlockItem>

  </DoVsDontRow>

  <CommonRulesDoAndDont />
</div>

### Performance

The Tooltip system is optimized to prevent unnecessary re-renders. When one tooltip opens, other tooltips on the page don't re-render.

</Tab>
</CustomTabs>
